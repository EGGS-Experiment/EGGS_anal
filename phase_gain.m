r_phase=[0.11,0.235,0.295,0.325,0.355,0.385,0.415...
    ,0.445,0.475,0.505,0.535,0.565,0.595,0.625...
    ,0.655,0.715];

D=[0.298,0.36,0.292,0.366,0.32];

T=[0.388,0.371,0.56,0.74,0.96,1.2,1.469,...
    1.5,1.72,1.4,1.438,1.08,0.945,0.766,...
    0.54,0.43]-0.17;

xx=r_phase*360-171;
yy=T./mean(D);

fo_phase = fitoptions('Method','NonlinearLeastSquares',...
    'Lower',[1.5, 0.2, -0.1, 2.8],...
    'Upper',[3, 1, 0.1, 4],...
    'StartPoint',[2, .3, 0, 3.4]);
ftphase = fittype('a*cos(2*pi*b*(2*pi/360*x-c))^2+d','options',fo_phase);
[curvephase,gofphase] = fit(xx.',yy.',ftphase);
            
figure;plot(xx,yy,'o')
hold on;
plot(curvephase)

hold off;
xlabel('phase (degree)')
ylabel('Gain')

xlim([-100 100])

sim_y=[0.21900476828806464,...
 0.27812428500180836,...
 0.5493141324471762,...
 1.0066594124308201,...
 1.6043460685399071,...
 2.283970316472669,...
 2.978699254510593,...
 3.6207201908974382,...
 4.146402055372131,...
 4.504642076475804,...
 4.659775795505112,...
 4.597405434335138,...
 4.3232126708996965,...
 3.86388936751808,...
 3.264390534394764,...
 2.5840856065670774,...
 1.8893063605718585,...
 1.248113663826344,...
 0.723947929383525,...
 0.36816018889960633,...
 0.21560981085921127];
sim_x=linspace(-90,90,21);
hold on
plot(sim_x,sim_y)
%%
s_p=[1.2,0.589,0.69,1.52,1.65];
r=log(sqrt(s_p)+sqrt(s_p+1));

D=[0.35,0.26];

T=1.4*[1.36,0.778,0.9,1.52,1.68];

r_t=0:0.1:1.2;

y_t=exp(r_t);
figure(100);plot(r_t,1*(y_t).^2)
hold on;

plot(r,T./mean(D),'or')

%% 
xpos=sqrt(yy).*cos(xx*2*pi/360);
ypos=sqrt(yy).*sin(xx*2*pi/360);

figure(465);
scatter(xpos,ypos);
hold on;

plot(viscircles([0,0],1));
